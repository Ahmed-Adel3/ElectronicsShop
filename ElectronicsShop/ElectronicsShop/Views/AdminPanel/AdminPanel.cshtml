@inject IViewLocalizer Localizer
@{
    ViewData["Title"] = "Home Page";
}

<div class="container text-center">
    <div class="row">
        <div class="col">
            <h1 class="display-4">@Localizer["OurProducts"]</h1>
        </div>

    </div>
            
    <div class="row">
        <div class="col">
            <div class="dropdown">
                <label for="dropdownMenuLink">Please select a type:</label>
                <a class="btn btn-secondary dropdown-toggle form-group" href="#" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    Dropdown link
                </a>

                <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                    <a class="dropdown-item" href="#">Action</a>
                    <a class="dropdown-item" href="#">Another action</a>
                    <a class="dropdown-item" href="#">Something else here</a>
                </div>
            </div>
        </div>

    </div>
    <div class="row">
        <div class="col">
            <div class="container-fluid">
                <table class="table table-striped table-hover">
                    <thead class="table-dark">
                        <tr>
                            <th scope="col">Product Name</th>
                            <th scope="col">Type</th>
                            <th scope="col">Price</th>
                            <th scope="col">Discount %</th>
                            <th scope="col">Final Price</th>
                            <th scope="col">Discount of two items</th>
                        </tr>
                    </thead>
                    <tbody id="gridBodyContainer">
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col">
            <div class="btn-group" role="group" aria-label="Basic example">
                <button type="button" class="btn btn-primary" id="prevBtn" disabled> <i class="fas fa-arrow-circle-left"></i> Previous</button>
                <button type="button" class="btn btn-primary" id="nextBtn"> Next <i class="fas fa-arrow-circle-right"></i></button>
            </div>
        </div>
    </div>
</div>

<div class="">



</div>


@section Scripts {
    <script>
        window.onload = (event) => {
            loadProducts(1);
        };

        let drawCard = returnData => {
            var gridBody = document.getElementById("gridBodyContainer");
            General.emptyNode(gridBody);
            returnData.ProductRows.forEach(row => gridBody.innerHTML +=
                `<tr>
                        <td>${row.Name}</td>
                        <td>${row.TypeName}</td>
                        <td>${row.OriginalPrice}</td>
                        <td>${row.Discount} %</td>
                        <td>${row.FinalPrice}</td>
                        <td>${row.DiscountOfTwo} %</td>
                    </tr>`);

            let prevBtn = document.getElementById('prevBtn');
            prevBtn.disabled = returnData.IsFirstPage;
            prevBtn.onclick = loadProducts.bind(this, returnData.CurrentPageNumber - 1);

            let nextBtn = document.getElementById('nextBtn');
            nextBtn.disabled = returnData.IsLastPage;
            nextBtn.onclick = loadProducts.bind(this, returnData.CurrentPageNumber + 1);
        }


        let loadProducts = pageNum => {
            General.sendAjax("/AdminPanel/GetGridData", data => drawCard(data), { pageNum })
        };
    </script>
}


